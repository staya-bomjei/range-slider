(()=>{"use strict";$((()=>{$(".js-control-panel").each(((t,e)=>{const a=$(e);new class{constructor(t){this.$component=t,this.$slider=$(".js-control-panel__slider",t),this.$min=$(".js-control-panel__min input",t),this.$max=$(".js-control-panel__max input",t),this.$step=$(".js-control-panel__step input",t),this.$from=$(".js-control-panel__from input",t),this.$to=$(".js-control-panel__to input",t),this.$parts=$(".js-control-panel__parts input",t),this.$vertical=$(".js-control-panel__vertical input",t),this.$range=$(".js-control-panel__range input",t),this.$scale=$(".js-control-panel__scale input",t),this.$bar=$(".js-control-panel__bar input",t),this.$tip=$(".js-control-panel__tip input",t)}init(){const{$slider:t,$component:e}=this,a=JSON.parse(e.attr("data-slider-options"));t.rangeSlider(a),this._updateInputs(),this._updateInputs=this._updateInputs.bind(this),this._handleMinChange=this._handleMinChange.bind(this),this._handleMaxChange=this._handleMaxChange.bind(this),this._handleStepChange=this._handleStepChange.bind(this),this._handleFromChange=this._handleFromChange.bind(this),this._handleToChange=this._handleToChange.bind(this),this._handlePartsChange=this._handlePartsChange.bind(this),this._handleVerticalChange=this._handleVerticalChange.bind(this),this._handleRangeChange=this._handleRangeChange.bind(this),this._handleScaleChange=this._handleScaleChange.bind(this),this._handleBarChange=this._handleBarChange.bind(this),this._handleTipChange=this._handleTipChange.bind(this),this._attachEventHandlers()}_attachEventHandlers(){const{$slider:t,$min:e,$max:a,$step:s,$from:n,$parts:i,$to:h,$range:l,$vertical:o,$scale:r,$tip:d,$bar:c}=this;t.rangeSlider("onchange",this._updateInputs),e.on("change",this._handleMinChange),a.on("change",this._handleMaxChange),s.on("change",this._handleStepChange),n.on("change",this._handleFromChange),h.on("change",this._handleToChange),i.on("change",this._handlePartsChange),o.on("change",this._handleVerticalChange),l.on("change",this._handleRangeChange),r.on("change",this._handleScaleChange),c.on("change",this._handleBarChange),d.on("change",this._handleTipChange)}_handleMinChange(){const{$min:t}=this,e=Number(t.val());this._setValidOptions({min:e})}_handleMaxChange(){const{$max:t}=this,e=Number(t.val());this._setValidOptions({max:e})}_handleStepChange(){const{$step:t}=this,e=Number(t.val());this._setValidOptions({step:e})}_handleFromChange(){const{$from:t}=this,e=Number(t.val());this._setValidOptions({valueFrom:e})}_handleToChange(){const{$to:t}=this,e=Number(t.val());this._setValidOptions({valueTo:e})}_handlePartsChange(){const{$parts:t}=this,e=Number(t.val());this._setValidOptions({scaleParts:e})}_handleVerticalChange(){let{orientation:t}=this._getOptions();t="horizontal"===t?"vertical":"horizontal",this._setOptions({orientation:t})}_handleRangeChange(){const{isRange:t}=this._getOptions();this._setValidOptions({isRange:!t})}_handleScaleChange(){const{showScale:t}=this._getOptions();this._setOptions({showScale:!t})}_handleBarChange(){const{showProgress:t}=this._getOptions();this._setOptions({showProgress:!t})}_handleTipChange(){const{showTooltip:t}=this._getOptions();this._setOptions({showTooltip:!t})}_getOptions(){const{$slider:t}=this;return t.rangeSlider("get")}_setOptions(t){const{$slider:e}=this;e.rangeSlider("set",t)}_setValidOptions(t,e=0){if(e>10)throw new Error("Stack Overflow");try{console.warn("try to set options",t),this._setOptions(t)}catch(a){const{value:s}=a;if(void 0===s)throw a;const n=this._getOptions(),{valueFrom:i,valueTo:h}={...n,...t},l=void 0!==t.min?t.min:n.min,o=void 0!==t.max?t.max:n.max,r="isRange"===s,d="scaleParts"===s,c="valueFrom"===s,_="valueTo"===s,p=c&&i===h;console.warn("start validation"),console.warn("original options: ",n),console.warn("trying to set options: ",t),console.error(`error message: ${a.message}`),p?this._setValidOptions({...t,valueFrom:l,valueTo:o},e+1):r||_?this._setValidOptions({...t,valueTo:o},e+1):d?this._setValidOptions({...t,scaleParts:1},e+1):c&&this._setValidOptions({...t,valueFrom:l},e+1),this._updateInputs(),console.warn("end validation")}}_updateInputs(){const{$slider:t,$min:e,$max:a,$step:s,$from:n,$parts:i,$to:h,$range:l,$vertical:o,$scale:r,$tip:d,$bar:c}=this,{min:_,max:p,step:g,valueFrom:$,valueTo:u,isRange:m,orientation:v,showScale:C,scaleParts:b,showTooltip:w,showProgress:O}=t.rangeSlider("get");e.val(_),a.val(p),s.val(g),n.val($),n.attr("min",_),n.attr("max",p),n.attr("step",g),C?(i.val(b),i.attr("disabled",!1)):(i.val(""),i.attr("disabled",!0)),m?(h.attr("disabled",!1),h.val(u),h.attr("min",_),h.attr("max",p),h.attr("step",g)):(h.attr("disabled",!0),h.val("")),l.attr("checked",m),o.attr("checked","vertical"===v),r.attr("checked",C),d.attr("checked",w),c.attr("checked",O)}}(a).init()}))}));$((()=>{$(".js-tapper-view").each(((t,e)=>{const a=$(e);new class{constructor(t){this.$component=t,this.$slider=$(".js-tapper-view__slider",t),this.$key=$(".js-tapper-view__key",t),this.$canvas=$(".js-tapper-view__canvas",t)}init(){const{$component:t,$slider:e,$canvas:a}=this,s=JSON.parse(t.attr("data-tappers")),n=s.map((t=>t.name));this.keys=s.map((t=>t.key)),this.keysBits=this.keys.map(((t,e)=>this._keyToBinaryArray(e))),e.rangeSlider({strings:n,showScale:!1}),a.attr("width",634),a.attr("height",100),this.ctx=a[0].getContext("2d"),this._update(),this._update=this._update.bind(this),this._attachEventHandlers()}_attachEventHandlers(){const{$slider:t}=this;t.rangeSlider("onchange",this._update)}_update(){this._updateKey(),this._updateCanvas()}_updateKey(){const{$slider:t,$key:e,keys:a}=this,{valueFrom:s}=t.rangeSlider("get");e.html(a[s])}_updateCanvas(){const{$slider:t,keysBits:e}=this,{valueFrom:a}=t.rangeSlider("get"),s=e[a];this._clearCanvas(),s.forEach(((t,e)=>{t&&this._drawCell(e)}))}_drawCell(t){const e=106-Math.trunc(t/17)-1,a=t%17,s=4*e+2*e,n=4*a+2*a,{ctx:i}=this;i.fillStyle="black",i.fillRect(s,n,4,4)}_clearCanvas(){const{$canvas:t,ctx:e}=this,a=Number(t.attr("width")),s=Number(t.attr("height"));e.fillStyle="white",e.fillRect(0,0,a,s)}_keyToBinaryArray(t){const{keys:e}=this;let a=BigInt(e[t])/BigInt(17);const s=[];for(;a>0n;)s.push(a%2n),a/=2n;return s}}(a).init()}))}))})();